# Video Processor API

A NestJS-based video processing API that extracts frames from video files and provides them as downloadable ZIP files. This project migrates the original Go implementation to a clean architecture pattern using TypeScript and NestJS.

## Features

- ğŸ¬ Video file upload and processing\n- ğŸ“¸ Frame extraction using FFmpeg (1 FPS)\n- ğŸ“¦ Automatic ZIP packaging of extracted frames\n- ğŸ“Š Processing status tracking\n- ğŸ“¥ File download functionality\n- ğŸš€ RESTful API with Swagger documentation\n- ğŸ§ª Comprehensive testing (Unit, Integration, BDD)\n- ğŸ³ Docker support for development\n- ğŸ—ï¸ Clean Architecture implementation\n\n## Supported Video Formats\n\n- MP4 (.mp4)\n- AVI (.avi)\n- MOV (.mov)\n- MKV (.mkv)\n- WMV (.wmv)\n- FLV (.flv)\n- WebM (.webm)\n\n## Architecture\n\nThis project follows Clean Architecture principles:\n\n```\nsrc/\nâ”œâ”€â”€ domain/                 # Business logic and entities\nâ”‚   â”œâ”€â”€ entities/          # Domain entities\nâ”‚   â”œâ”€â”€ repositories/      # Repository interfaces\nâ”‚   â”œâ”€â”€ value-objects/     # Value objects\nâ”‚   â””â”€â”€ exceptions/        # Domain exceptions\nâ”œâ”€â”€ application/           # Application services\nâ”‚   â”œâ”€â”€ use-cases/        # Business use cases\nâ”‚   â””â”€â”€ dto/              # Data transfer objects\nâ”œâ”€â”€ infrastructure/        # External concerns\nâ”‚   â”œâ”€â”€ repositories/     # Repository implementations\nâ”‚   â””â”€â”€ services/         # External services\nâ”œâ”€â”€ presentation/          # Controllers and API\nâ”‚   â””â”€â”€ controllers/      # REST controllers\nâ””â”€â”€ shared/               # Shared utilities\n    â”œâ”€â”€ interfaces/       # Shared interfaces\n    â””â”€â”€ utils/           # Utility functions\n```\n\n## Getting Started\n\n### Prerequisites\n\n- Node.js 18+\n- npm or yarn\n- Docker (for development)\n- FFmpeg (automatically installed in Docker)\n\n### Installation\n\n1. Clone the repository:\n```bash\ngit clone <repository-url>\ncd video-processor-api\n```\n\n2. Install dependencies:\n```bash\nnpm install\n```\n\n3. Copy environment file:\n```bash\ncp .env.example .env\n```\n\n4. Create required directories:\n```bash\nmkdir -p uploads outputs temp\n```\n\n### Development with Docker\n\n1. Start the development environment:\n```bash\nnpm run docker:dev\n```\n\n2. The API will be available at:\n   - API: http://localhost:3000/api/v1\n   - Swagger Docs: http://localhost:3000/api/docs\n\n3. Stop the environment:\n```bash\nnpm run docker:down\n```\n\n### Local Development\n\n1. Install FFmpeg on your system:\n   - macOS: `brew install ffmpeg`\n   - Ubuntu: `sudo apt install ffmpeg`\n   - Windows: Download from https://ffmpeg.org/\n\n2. Start the development server:\n```bash\nnpm run start:dev\n```\n\n## API Endpoints\n\n### Upload and Process Video\n```http\nPOST /api/v1/videos/upload\nContent-Type: multipart/form-data\n\nForm data:\n- video: [video file]\n```\n\n### Get Processing Status\n```http\nGET /api/v1/videos/status\n```\n\n### Download Processed Frames\n```http\nGET /api/v1/videos/download/{filename}\n```\n\n## Testing\n\n### Run All Tests\n```bash\nnpm run test:all\n```\n\n### Run Specific Test Types\n```bash\n# Unit tests\nnpm run test:unit\n\n# Integration tests\nnpm run test:integration\n\n# BDD tests\nnpm run test:bdd\n\n# Coverage report\nnpm run test:cov\n```\n\n### Test Structure\n\n- **Unit Tests**: Test individual components in isolation\n- **Integration Tests**: Test API endpoints and component integration\n- **BDD Tests**: Behavior-driven tests using Cucumber\n\n## Configuration\n\nEnvironment variables (see `.env.example`):\n\n| Variable | Description | Default |\n|----------|-------------|----------|\n| `NODE_ENV` | Environment | `development` |\n| `PORT` | Server port | `3000` |\n| `UPLOAD_PATH` | Upload directory | `./uploads` |\n| `OUTPUT_PATH` | Output directory | `./outputs` |\n| `TEMP_PATH` | Temporary directory | `./temp` |\n| `MAX_FILE_SIZE` | Max file size | `100MB` |\n| `THROTTLE_TTL` | Rate limit window (ms) | `60000` |\n| `THROTTLE_LIMIT` | Rate limit requests | `10` |\n\n## Production Deployment\n\n1. Build the application:\n```bash\nnpm run build\n```\n\n2. Use the production Dockerfile:\n```bash\ndocker build -t video-processor-api .\ndocker run -p 3000:3000 video-processor-api\n```\n\n## Error Handling\n\nThe API includes comprehensive error handling:\n\n- **400 Bad Request**: Invalid file format, file too large\n- **404 Not Found**: File not found for download\n- **500 Internal Server Error**: Processing failures\n\n## Monitoring and Logging\n\nThe application includes:\n- Structured logging with NestJS Logger\n- Request/response logging\n- Error tracking\n- Processing metrics\n\n## Contributing\n\n1. Follow the existing code style\n2. Write tests for new features\n3. Update documentation\n4. Follow clean architecture principles\n\n## License\n\nMIT License - see LICENSE file for details.